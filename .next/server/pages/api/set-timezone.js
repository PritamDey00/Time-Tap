"use strict";(()=>{var e={};e.id=7704,e.ids=[7704],e.modules={8432:e=>{e.exports=require("bcryptjs")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},2007:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>d,routeModule:()=>p});var a=r(1802),n=r(7153),o=r(6249),i=r(801),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,o.l)(i,"default"),l=(0,o.l)(i,"config"),p=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/set-timezone",pathname:"/api/set-timezone",bundlePath:"",filename:""},userland:i});s()}catch(e){s(e)}})},801:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>handler});var a=r(9344),n=r.n(a),o=r(8936),i=e([o]);o=(i.then?(await i)():i)[0];let u=process.env.JWT_SECRET||"dev-secret";async function handler(e,t){let r;if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let s=e.headers.cookie||"",a=s.split(";").map(e=>e.trim()).find(e=>e.startsWith("auth="));if(!a)return t.status(401).json({error:"Not authenticated"});let i=a.split("=")[1];try{r=n().verify(i,u)}catch(e){return t.status(401).json({error:"Invalid token"})}let{timezone:d}=e.body||{};if(!d||"string"!=typeof d)return t.status(400).json({error:"Missing timezone"});let l=await (0,o.GG)(r.name);if(!l)return t.status(404).json({error:"User not found"});try{new Intl.DateTimeFormat("en-US",{timeZone:d}).format()}catch(e){return t.status(400).json({error:"Invalid timezone"})}l.timezone=d,await (0,o.Nq)(l),t.json({success:!0,timezone:d})}s()}catch(e){s(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,7316,8936],()=>__webpack_exec__(2007));module.exports=r})();