"use strict";(()=>{var e={};e.id=4358,e.ids=[4358],e.modules={4802:e=>{e.exports=require("cookie")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},6555:e=>{e.exports=import("uuid")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},8524:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>p});var s=r(1802),a=r(7153),i=r(6249),d=r(3824),n=e([d]);d=(n.then?(await n)():n)[0];let u=(0,i.l)(d,"default"),l=(0,i.l)(d,"config"),p=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/personal-todos",pathname:"/api/personal-todos",bundlePath:"",filename:""},userland:d});o()}catch(e){o(e)}})},3824:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{default:()=>handler});var s=r(7352),a=r(9344),i=r.n(a),d=r(4802),n=r(6555),u=r(7665),l=e([s,n]);[s,n]=l.then?(await l)():l;let p=process.env.JWT_SECRET||"dev-secret";async function handler(e,t){try{console.log("Personal todos API request:",{method:e.method,timestamp:new Date().toISOString()});let r=function(e){let t=(0,d.parse)(e.headers.cookie||""),r=t.auth;if(!r)throw Error("No token provided");try{return i().verify(r,p)}catch(e){throw Error("Invalid token")}}(e);if("GET"===e.method){let e=await (0,s.hL)(),o=e.filter(e=>e.userId===r.id&&!e.classroomId);return t.status(200).json(o)}if("POST"!==e.method)return t.setHeader("Allow",["GET","POST"]),t.status(405).json({error:"Method not allowed",type:"validation",message:"This endpoint only supports GET and POST methods"});{(0,u.Gl)(e,{text:!0,priority:!1});let{text:o,priority:a}=e.body;if(!o?.trim())throw Error("Text is required");let i=await (0,s.hL)(),d={id:(0,n.v4)(),userId:r.id,text:o.trim(),completed:!1,priority:a||"medium",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return i.push(d),await (0,s.Yr)(i),console.log("Todo created successfully:",{todoId:d.id,userId:r.id}),t.status(201).json(d)}}catch(e){return(0,u.zG)(e,t)}}o()}catch(e){o(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,7316,7665,7352],()=>__webpack_exec__(8524));module.exports=r})();