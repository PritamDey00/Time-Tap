"use strict";(()=>{var e={};e.id=2829,e.ids=[2829],e.modules={8432:e=>{e.exports=require("bcryptjs")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},9440:(e,n,t)=>{t.a(e,async(e,a)=>{try{t.r(n),t.d(n,{config:()=>p,default:()=>u,routeModule:()=>c});var s=t(1802),o=t(7153),r=t(6249),l=t(2806),i=e([l]);l=(i.then?(await i)():i)[0];let u=(0,r.l)(l,"default"),p=(0,r.l)(l,"config"),c=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/users",pathname:"/api/users",bundlePath:"",filename:""},userland:l});a()}catch(e){a(e)}})},2806:(e,n,t)=>{t.a(e,async(e,a)=>{try{t.r(n),t.d(n,{default:()=>handler});var s=t(8936),o=t(7665),r=e([s]);function calculateOnlineStatus(e){if(!e)return"offline";let n=new Date,t=new Date(e),a=(n-t)/6e4;return a<=5?"online":a<=30?"away":"offline"}async function handler(e,n){try{if((0,o.VX)(e,{endpoint:"users"}),"GET"!==e.method)return n.status(405).json({error:"Method not allowed",type:"method",message:"This endpoint only supports GET requests"});let t=await (0,s.p_)();t.sort((e,n)=>{let t=calculateOnlineStatus(e.lastSeen),a=calculateOnlineStatus(n.lastSeen),s={online:3,away:2,offline:1},o=s[a]-s[t];return 0!==o?o:n.points-e.points||e.name.localeCompare(n.name)});let a=t.map(e=>({id:e.id,name:e.isAnonymous?e.anonymousName||"Anonymous User":e.name,points:e.points,streak:e.streak,lastConfirm:e.lastConfirm,avatar:e.isAnonymous?null:e.avatar||null,lastSeen:e.lastSeen||null,onlineStatus:calculateOnlineStatus(e.lastSeen),isAnonymous:e.isAnonymous||!1,anonymousName:e.anonymousName||null}));console.log("Users loaded successfully:",{count:a.length}),n.json({users:a})}catch(a){let t=(0,o.Ts)(e);return t.endpoint="users",(0,o.zG)(a,n,t)}}s=(r.then?(await r)():r)[0],a()}catch(e){a(e)}})}};var n=require("../../webpack-api-runtime.js");n.C(e);var __webpack_exec__=e=>n(n.s=e),t=n.X(0,[4222,7316,8936,7665],()=>__webpack_exec__(9440));module.exports=t})();