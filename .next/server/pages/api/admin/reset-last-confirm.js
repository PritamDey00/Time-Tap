"use strict";(()=>{var e={};e.id=8973,e.ids=[8973],e.modules={8432:e=>{e.exports=require("bcryptjs")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},3594:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>c});var s=r(1802),n=r(7153),i=r(6249),o=r(9701),l=e([o]);o=(l.then?(await l)():l)[0];let u=(0,i.l)(o,"default"),d=(0,i.l)(o,"config"),c=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/admin/reset-last-confirm",pathname:"/api/admin/reset-last-confirm",bundlePath:"",filename:""},userland:o});a()}catch(e){a(e)}})},9701:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>handler});var s=r(9344),n=r.n(s),i=r(8936),o=e([i]);i=(o.then?(await o)():o)[0];let l=process.env.JWT_SECRET||"dev-secret";async function handler(e,t){let r;if("POST"!==e.method){t.status(405).json({error:"Method not allowed"});return}let a=e.headers.cookie||"",s=a.split(";").map(e=>e.trim()).find(e=>e.startsWith("auth="));if(!s){t.status(401).json({error:"Not authenticated"});return}let o=s.split("=")[1];try{r=n().verify(o,l)}catch(e){t.status(401).json({error:"Invalid token"});return}let u=await (0,i.GG)(r.name);if(!u){t.status(404).json({error:"User not found"});return}let d=new Date(Date.now()-18e5).toISOString();u.lastConfirm=d;let c=await (0,i.Nq)(u);t.json({success:!0,user:{id:c.id,name:c.name,lastConfirm:c.lastConfirm},message:"lastConfirm reset to 30 minutes ago - confirmation window should be available"})}a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,7316,8936],()=>__webpack_exec__(3594));module.exports=r})();