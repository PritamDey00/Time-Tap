"use strict";(()=>{var e={};e.id=1826,e.ids=[1826],e.modules={4802:e=>{e.exports=require("cookie")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1721:e=>{e.exports=import("@upstash/redis")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},654:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{config:()=>c,default:()=>u,routeModule:()=>l});var s=t(1802),a=t(7153),n=t(6249),i=t(5220),d=e([i]);i=(d.then?(await d)():d)[0];let u=(0,n.l)(i,"default"),c=(0,n.l)(i,"config"),l=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/todos",pathname:"/api/todos",bundlePath:"",filename:""},userland:i});o()}catch(e){o(e)}})},5220:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{default:()=>handler});var s=t(7352),a=t(9344),n=t.n(a),i=t(4802),d=e([s]);s=(d.then?(await d)():d)[0];let u=process.env.JWT_SECRET||"dev-secret";async function handler(e,r){try{let t=function(e){let r=(0,i.parse)(e.headers.cookie||""),t=r.auth;if(!t)throw Error("No token provided");try{return n().verify(t,u)}catch(e){throw Error("Invalid token")}}(e);if("GET"===e.method){let{userId:o,classroomId:a}=e.query;if(o!==t.id)return r.status(403).json({error:"Access denied"});if(!a)return r.status(400).json({error:"classroomId is required"});let n=await (0,s.w8)(o,a);return r.status(200).json(n)}if("POST"!==e.method)return r.setHeader("Allow",["GET","POST"]),r.status(405).json({error:"Method not allowed"});{let{userId:o,classroomId:a,text:n,priority:i}=e.body;if(o!==t.id)return r.status(403).json({error:"Access denied"});if(!a||!n?.trim())return r.status(400).json({error:"classroomId and text are required"});let d=await (0,s.JV)({userId:o,classroomId:a,text:n.trim(),priority:i||"medium"});return r.status(201).json(d)}}catch(e){if(console.error("Todo API error:",e),"No token provided"===e.message||"Invalid token"===e.message)return r.status(401).json({error:"Unauthorized"});return r.status(500).json({error:"Internal server error"})}}o()}catch(e){o(e)}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222,7316,7352],()=>__webpack_exec__(654));module.exports=t})();