"use strict";exports.id=7352,exports.ids=[7352],exports.modules={7352:(o,t,e)=>{e.a(o,async(o,r)=>{try{e.d(t,{CU:()=>updateTodo,JV:()=>createTodo,Yr:()=>saveTodos,aS:()=>deleteTodo,cu:()=>toggleTodoCompletion,hL:()=>loadTodos,w8:()=>getUserClassroomTodos});var a=e(7316),s=o([a]);a=(s.then?(await s)():s)[0];let n="todos",d=Promise.resolve();async function ensureStore(){let o=(0,a.jR)();try{let t=await o.exists(n);t||await o.set(n,[])}catch(t){console.error("Error ensuring todos store:",t.message);try{await o.set(n,[])}catch(o){throw console.error("Failed to initialize todos store:",o.message),Error("Unable to initialize todos storage")}}}async function loadTodos(){try{await ensureStore();let o=(0,a.jR)(),t=await o.get(n);if(null==t)return console.log("No todos data found, initializing with empty array"),await saveTodosInternal([]),[];if(!Array.isArray(t))return console.error("Invalid todos data structure, resetting to empty array"),await saveTodosInternal([]),[];return t}catch(o){console.error("Error loading todos:",{error:o.message,stack:o.stack,storageKey:n});try{return await saveTodosInternal([]),[]}catch(o){throw console.error("Failed to reset todos after load error:",o.message),Error("Unable to load or reset todos data")}}}async function saveTodosInternal(o){if(await ensureStore(),!Array.isArray(o))throw Error("Todos must be an array");try{let t=(0,a.jR)();await t.set(n,o)}catch(o){throw console.error("Error saving todos:",o.message),Error(`Failed to save todos: ${o.message}`)}}async function saveTodos(o){return d=d.then(()=>saveTodosInternal(o))}async function getUserClassroomTodos(o,t){let e=await loadTodos();return e.filter(e=>e.userId===o&&e.classroomId===t)}async function createTodo({userId:o,classroomId:t,text:e,priority:r="medium"}){if(!o||!t||!e?.trim())throw Error("Missing required fields: userId, classroomId, and text are required");let a=await loadTodos(),s={id:Date.now().toString(36)+Math.random().toString(36).substring(2),userId:o,classroomId:t,text:e.trim(),completed:!1,priority:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return a.push(s),await saveTodos(a),s}async function updateTodo(o,t){let e=await loadTodos(),r=e.findIndex(t=>t.id===o);if(-1===r)throw Error("Todo not found");let a={...e[r],...t,updatedAt:new Date().toISOString()};return e[r]=a,await saveTodos(e),a}async function deleteTodo(o){let t=await loadTodos(),e=t.findIndex(t=>t.id===o);if(-1===e)throw Error("Todo not found");return t.splice(e,1),await saveTodos(t),!0}async function toggleTodoCompletion(o){let t=await loadTodos(),e=t.findIndex(t=>t.id===o);if(-1===e)throw Error("Todo not found");return t[e].completed=!t[e].completed,t[e].updatedAt=new Date().toISOString(),await saveTodos(t),t[e]}r()}catch(o){r(o)}})}};